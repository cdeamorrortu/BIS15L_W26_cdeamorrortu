filter(period == 2023 & common_name == "Alaska pollock(=Walleye poll.)") %>%
select(common_name, catch, country) %>%
group_by(country) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
arrange(desc(catch)) %>%
slice_head(n = 1)
fisheries_clean %>%
select(catch, period, common_name) %>%
filter(period == 2013 | period == 2014 | period == 2015 | period == 2016 | period == 2017 | period == 2018 | period == 2019 | period == 2020 | period == 2021 | period == 2022 | period == 2023) %>%
filter(common_name == "Alaska pollock(=Walleye poll.)") %>%
ggplot(mapping = aes(x = period)) +
geom_bar(mapping = aes(fill = period)) +
labs(title = "Alaskan Pollock Fishing 2013 - 2023", x = "Year", y = "Count")
"How has fishing of Crucian Carp changed in Europe in the past decade?"
fisheries_clean %>%
select(catch, common_name, continent, period) %>%
filter(continent == "Europe" & common_name == "Crucian carp") %>%
filter(period == 2013 | period == 2014 | period == 2015 | period == 2016 | period == 2017 | period == 2018 | period == 2019 | period == 2020 | period == 2021 | period == 2022 | period == 2023) %>%
ggplot(mapping = aes(x = period)) +
geom_bar(mapping = aes(fill = period)) +
labs(title = "Crucian Carps Caught in Europe in the Decade 2013 - 2023", x = "Year", y = "Count")
fisheries_clean %>%
group_by(county) %>%
distinct() %>%
count()
sharks %>%
group_by(county) %>%
distinct() %>%
count()
sharks %>%
group_by(county) %>%
distinct() %>%
count() %>%
arrange(desc(n)) %>%
slice_max(n = 5)
sharks %>%
group_by(county) %>%
distinct() %>%
count()
sharks %>%
group_by(county) %>%
distinct() %>%
count() %>%
arrange()
sharks %>%
group_by(county) %>%
distinct() %>%
count() %>%
arrange(n)
sharks %>%
group_by(county) %>%
distinct() %>%
count() %>%
arrange(desc(n))
sharks %>%
group_by(county) %>%
distinct() %>%
count() %>%
arrange(desc(n)) %>%
slice_head(n = 5)
sharks %>%
group_by(county) %>%
distinct() %>%
count() %>%
arrange(desc(n))
sharks %>%
group_by(county) %>%
distinct() %>%
count() %>%
arrange(desc(n)) %>%
slice_head(n = 5)
sharks %>%
group_by(county) %>%
distinct() %>%
count() %>%
arrange(desc(n)) %>%
slice_head(n = 5)
sharks %>%
group_by(county) %>%
distinct() %>%
count() %>%
arrange(desc(n))
?slice_
sharks %>%
group_by(county) %>%
count(county) %>%
distinct() %>%
arrange(desc(n)) %>%
slice_head(n = 5)
sharks %>%
group_by(county) %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) M
sharks %>%
group_by(county) %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
arrange(desc(n)) %>%
slice_head(n = 5)
sharks %>%
ggplot(x = county) %>%
geom_bar(mapping = aes(fill = county))
sharks %>%
ggplot(mapping = aes(x = county)) %>%
geom_bar(mapping = aes(fill = county))
sharks %>%
ggplot(mapping = aes(x = county)) +
geom_bar(mapping = aes(fill = county))
sharks %>%
ggplot(mapping = aes(x = county)) +
geom_bar(mapping = aes(fill = county)) +
coord_flip()
sharks %>%
ggplot(mapping = aes(x = month)) +
geom_bar(mapping = aes(fill = month))
sharks %>%
ggplot(mapping = aes(x = month)) +
geom_bar(mapping = aes(fill = "month"))
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = ))
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month)))
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month")
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = month)) +
labs(title = "Shark Attacks by Month", x = "Month")
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month")
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month", key = "Month")
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month", legend = "Month")
sharks %>%
ggplot2(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month", legend = "Month")
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month", color = "Month")
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month") +labs(colour="NEW LEGEND TITLE")
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month") + theme(legend.title = element_blank())
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month") + theme(legend.title = "Month")
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month") + theme(legend.title = element_text("Month"))
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month") + theme(legend.title = element_blank())
?element_text
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month", fill = "Month")
library("tidyverse")
library("janitor")
sharks <-
read_csv("data/SharkIncidents_1950_2022_220302.csv",
na=c("NA", "N/A", "Unknown", "NOT COUNTED", "", " ")) %>%
clean_names()
sharks %>%
group_by(county) %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
arrange(desc(n)) %>%
slice_head(n = 5)
sharks %>%
ggplot(mapping = aes(x = county)) +
geom_bar(mapping = aes(fill = county)) +
coord_flip()
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month", fill = "Month")
sharks
sharks
sharks %>%
ggplot(mapping = aes(x = as.factor(time))) +
geom_bar(mapping = aes(fill = as.factor(time))) +
labs(title = "Shark Attacks by Hour", x = "Time of Day", fill = "Time of Day")
sharks %>%
ggplot(mapping = aes(x = as.factor(time))) +
geom_bar(mapping = aes(fill = as.factor(time))) +
labs(title = "Shark Attacks by Hour", x = "Time of Day", fill = "Time of Day") +
coord_flip()
sharks %>%
ggplot(mapping = aes(x = as.factor(time))) +
geom_bar(mapping = aes(fill = as.factor(time))) +
labs(title = "Shark Attacks by Hour", x = "Time of Day", fill = "Time of Day") +
coord_flip() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
sharks %>%
ggplot(mapping = aes(x = as.factor(time))) +
geom_bar(mapping = aes(fill = as.factor(time))) +
labs(title = "Shark Attacks by Hour", x = "Time of Day", fill = "Time of Day") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
sharks %>%
ggplot(mapping = aes(x = as.factor(time))) +
geom_bar(mapping = aes(fill = as.factor(time))) +
labs(title = "Shark Attacks by Hour", x = "Time of Day", fill = "Time of Day") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
sharks$injury
sharks %>%
group_by(county) %>%
count(injurty)
sharks %>%
group_by(county) %>%
count(injury)
sharks %>%
group_by(county) %>%
pivot_wider(names_from = injury, values_from = n)
sharks %>%
group_by(county) %>%
count(injury %>% )
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n)
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T)))
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = summarize())
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T)))
San Mateo County has the highest number incidents.
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T)))
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
ggplot(x = county, y = sum("minor" :"major*")) +
geom_col(mapping = aes(fill = county))
?geom_col
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = sum(minor : major*))
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = sum(minor : major*))
?mutate
ggplot(x = county, y = total) +
geom_col(mapping = aes(fill = county))
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) M
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) M
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
ggplot(x = county, y = total) +
geom_col(mapping = aes(fill = county))
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
ggplot(x = county, y = total) +
geom_col(mapping = aes(x = county, y = total, fill = county))
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
ggplot(x = county, y = total) +
geom_col(mapping = aes(x = county, y = total, fill = county)) +
coord_flip()
sharks %>%
group_by(mode) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
select(mode, total)
sharks %>%
group_by(mode) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
ggplot(x = mode, y = total) +
geom_col(mapping = aes(x = mode, y = total, fill = mode)) +
coord_flip()
sharks
sharks %>%
group_by(species) %>%
count(injury) %>%
pivot_wider(names_from = species, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
select(species, total)
sharks %>%
group_by(species) %>%
count(injury) %>%
pivot_wider(names_from = species, values_from = n) #%>%
#summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
#mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
#select(species, total)
sharks %>%
group_by(species) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
select(species, total)
sharks %>%
filter(species == "White") %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n)
sharks %>%
filter(species == "White") %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n)
sharks %>%
filter(species == "White") %>%
pivot_wider(names_from = injury, values_from = n)
sharks %>%
filter(species == "White") %>%
group_by(injury)
sharks %>%
filter(species == "White") %>%
select(injury)
geom_bar(mapping = aes(x = injury, fill = injury)
geom_bar(mapping = aes(x = injury, fill = injury)
sharks %>%
filter(species == "White") %>%
select(injury) %>%
ggplot(x  = injury) %>%
geom_bar(mapping = aes(x = injury, fill = injury))
sharks %>%
filter(species == "White") %>%
ggplot(x  = injury) %>%
geom_bar(mapping = aes(x = injury, fill = injury))
sharks %>%
filter(species == "White") %>%
ggplot(mapping = aes(x  = injury)) %>%
geom_bar(mapping = aes(x = injury, fill = injury))
sharks %>%
filter(species == "White") %>%
ggplot(mapping = aes(x = injury)) +
geom_bar(mapping = aes(fill = injury)) +
```
sharks %>%
filter(species == "White") %>%
ggplot(mapping = aes(x = injury)) +
geom_bar(mapping = aes(fill = injury))
sharks %>%
filter(species == "White") %>%
ggplot(mapping = aes(x = injury)) +
geom_bar(mapping = aes(fill = injury)) +
labs(title = "Great White Shark Attacks by Injury Type", x = "Injurty", y = "Count")
sharks %>%
group_by(mode) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
ggplot(x = mode, y = total) +
geom_col(mapping = aes(x = mode, y = total, fill = mode)) +
coord_flip() +
labs(title = "Incidents by Activity Type", x = "Mode", y = "Number of Incidents")
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
ggplot(x = county, y = total) +
geom_col(mapping = aes(x = county, y = total, fill = county)) +
coord_flip()  +
labs(title = "Number of Accidents by County", x = "County", y = "Accidents")
sharks %>%
ggplot(mapping = aes(x = as.factor(time))) +
geom_bar(mapping = aes(fill = as.factor(time))) +
labs(title = "Shark Attacks by Hour", x = "Time of Day", fill = "Time of Day") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Number of Accidents by Time of Day", x = "Time of Day", y = "Number of Accidents")
library("tidyverse")
library("janitor")
sharks <-
read_csv("data/SharkIncidents_1950_2022_220302.csv",
na=c("NA", "N/A", "Unknown", "NOT COUNTED", "", " ")) %>%
clean_names()
sharks %>%
group_by(county) %>%
count(county) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
arrange(desc(n)) %>%
slice_head(n = 5)
sharks %>%
ggplot(mapping = aes(x = county)) +
geom_bar(mapping = aes(fill = county)) +
coord_flip()
sharks %>%
ggplot(mapping = aes(x = as.factor(month))) +
geom_bar(mapping = aes(fill = as.factor(month))) +
labs(title = "Shark Attacks by Month", x = "Month", fill = "Month")
"October has the highest number of incidents."
sharks %>%
ggplot(mapping = aes(x = as.factor(time))) +
geom_bar(mapping = aes(fill = as.factor(time))) +
labs(title = "Shark Attacks by Hour", x = "Time of Day", fill = "Time of Day") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Number of Accidents by Time of Day", x = "Time of Day", y = "Number of Accidents")
"The most amount of shark attacks happen at 10:45"
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T)))
"San Mateo County has the highest number incidents."
sharks %>%
group_by(county) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
ggplot(x = county, y = total) +
geom_col(mapping = aes(x = county, y = total, fill = county)) +
coord_flip()  +
labs(title = "Number of Accidents by County", x = "County", y = "Accidents")
"San Diego County has the highest number of incidents"
sharks %>%
group_by(mode) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
select(mode, total)
sharks %>%
group_by(mode) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
ggplot(x = mode, y = total) +
geom_col(mapping = aes(x = mode, y = total, fill = mode)) +
coord_flip() +
labs(title = "Incidents by Activity Type", x = "Mode", y = "Number of Incidents")
sharks %>%
group_by(species) %>%
count(injury) %>%
pivot_wider(names_from = injury, values_from = n) %>%
summarize(across(where(is.numeric), ~sum(.x, na.rm = T))) %>%
mutate(total = (minor + minor* + major + major* + none + none* + fatal)) %>%
select(species, total)
sharks %>%
filter(species == "White") %>%
ggplot(mapping = aes(x = injury)) +
geom_bar(mapping = aes(fill = injury)) +
labs(title = "Great White Shark Attacks by Injury Type", x = "Injurty", y = "Count")
sharks %>%
ggplot(mapping = aes(x = county)) +
geom_bar(mapping = aes(fill = county)) +
coord_flip() +
labs(title = "Number of Incidents per County", x = "County", y = "Number of Incidents")
